### PRD（产品需求文档）—— Kids AI MVP v0.1.0

#### 1. 背景与目标
- 背景：为 3 岁儿童提供“勇敢、逻辑、爱家人”主题的启蒙学习助手，结合孩子偏好（红色、磁力片、积木、音乐），支持个性化与家长共育。
- 目标：在家庭场景中，提供简短而有结构的互动微课与故事生成，建立“提问-回应-巩固”闭环，降低家长学习组织门槛。

#### 2. 目标用户
- 主要：3 岁儿童（核心交互），家长（陪伴与运营视角）。
- 次要：研发/运营/QA（内容与系统维护）。

#### 3. 范围（MoSCoW）
- Must：
  - 聊天对话（SSE/非流式），基于“脚手架”对话策略（激活→引导→表达→巩固）。
  - 今日微课：按“2 卡片 + 1 故事 + 1 家庭 + 1 逻辑”结构输出。
  - 轻量 RAG（TF‑IDF + 可选向量），结合 `kids_3yo_dataset.json` 个性化上下文注入。
  - 内容安全：输出体裁与措辞的安全复写（温柔、无恐惧、无不当暗示）。
  - 家长中心：夜间模式、服务指标查看、陪伴提示（3 句内）。
- Should：
  - 多提供商容错（重试/熔断/故障转移）。/ready 与 /metrics 自运营。
  - 概念标签与难度分级（便于后续掌握度建模）。
- Could：
  - 向量检索（BGE）与轻量重排（BGE reranker 或 LLM 重排）。
  - 图片识别 PoC（拼搭/涂鸦讲述）。儿化 TTS PoC。
  - 家长看板图表化（趋势/柱状/热力图），每周 CSV/PDF 导出。

#### 4. 用户故事与流程
- 作为孩子，我可以在“聊天”里得到简短温柔的分步引导，并且能中途停止。
- 作为家长，我可以一键看到今日微课与陪伴提示，指导孩子一起完成。
- 作为家长，我可以查看服务是否可用（健康/就绪），并在异常时快速排障。

#### 5. 教学法与内容
- 脚手架模板：激活（观察/回忆）→引导（比较/分类）→表达（描述/创作）→巩固（迁移/归纳）。
- 主题：勇敢（积极尝试、面对困难）、逻辑（比较、分类、因果）、爱家人（表达感谢与帮助）。

#### 6. 个性化与RAG
- 轻量 RAG：TF‑IDF +（可选）Embeddings 混合；按孩子最近偏好与主题做上下文注入。
- 可配置：`AI_PROVIDERS` 指向 OpenAI 兼容 `/v1/embeddings` 开启向量检索。

#### 7. 安全与合规
- 输出风格：无惊吓、无暴力、无歧视、无成人内容；避免恐惧词汇。
- 日志脱敏：Trace-Id 贯穿，无个人敏感信息；可按环境级别采样。

#### 8. 性能与SLA
- 体验：首 token p95 < 1.2s；整答 p95 < 5s；SSE 稳定断线可恢复（退避+抖动）。
- 稳定：故障转移成功率 > 99%，/ready 反映熔断状态。

#### 9. 依赖与约束
- 后端：FastAPI、httpx、Pydantic、Prometheus 指标。
- 前端：Vite + React + TS；SSE 客户端（ReadableStream）。

#### 10. KPI
- 每日微课完成率 ≥ 60%
- 家长提示采用率 ≥ 40%
- 7 日留存 ≥ 35%
 - 每周导出覆盖率 ≥ 80%

#### 11. 验收标准（DoD）
- 功能：聊天/微课/安全/家长中心可用；SSE 可停止与自恢复。
- 观测：/metrics（HTTP/LLM/embeddings/rerank/failover）、/ready（熔断），结构化日志。
- 质量：单测与集成测通过；E2E 烟雾可跑；前端构建通过。

#### 12. 发布计划
- 标签：v0.1.0-mvp 已发布。
- 后续迭代：掌握度建模 + 轻量重排 + 家长看板。

